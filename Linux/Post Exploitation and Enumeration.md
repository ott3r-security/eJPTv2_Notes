
Gather linux configurations
`post/linux/gather/enum_configs`

Gather env variable? (also can use `env` via terminal)
`post/multi/gather/env`

Enum network
`linix/gather/enum_network`

Check for system hardening
`linux/gather/enum_protection`

Gather system and user info
`linux/gather/enum_system`

Check for docker
`post/linux/gather/checkcontainer`

Check for VM
`post/gather/checkvm`

Enumeration user history
`post/linux/gather/enum_users_history`

Full list:
- post/linux/gather/enum_configs
- post/multi/gather/env
- post/linux/gather/enum_network
- post/linux/gather/enum_protections
- post/linux/gather/enum_system
- post/linux/gather/checkcontainer
- post/linux/gather/checkvm
- post/linux/gather/enum_users_history
- post/multi/manage/system_session
- post/linux/manage/download_exec


## Enumeration post exploit

![](<Images/Pasted image 20240117204919.png>)

hostname: will print hostname
cat /etc/issue: gives version of linux
cat /etc/{asterix}release: more detailed info
uname -a: hostname, kernel
env: show enviroment variables
lscpu: print out CUP info
dpkg -l: prints installed packages

### Enumerating Users

meterpreter:
getuid: get user ID. UID=0=root

shell:
groups: showsgroups
groups {user} shows groups per user
usermod -aG {user}: add user to group
who:shows current logged in users
last:shows last users logged on
lastlog: list out users from passed and when they've logged in

### Enumerating Network Information

meterpreter:
netstat: shows current connections (works in shell as well)
route: displays routing table
arp: shows arp cache

shell:
cat /etc/networks: network info
cat /etc/hostname: gives hostname
cat /etc/host: shows host/ip setup
cat /etc/resolv.conf: shows dns info
arp -a: shows arp info
	if arp isn't installed meterpreter can use arp

### Automating Linux Local Enumeration

LinEnum - automatic linux enum found on github
LinPeas: file is way too big to copy and paste
[linux-smart-enumeration](https://github.com/diego-treitos/linux-smart-enumeration/blob/master/lse.sh): this works well to tell what is available. But doesn't give actual detail. Changing level to 1 or 2 will give more information

meterpreter:
enum_configs: gathers linux configurations (conf files)
enum_network: saves network info into loot table
enum_system: gets system info and saves it
checkvm: checks to see if machine in a vm


